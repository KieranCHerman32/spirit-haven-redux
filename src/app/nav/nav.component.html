<ng-container *ngIf="env.burn_ban_in_effect">
  <app-burn-banner>
  </app-burn-banner>
</ng-container>

<mat-toolbar (mouseleave)="closeAll()" (mouseover)="hover()">
  <div class="row align-items-center no-gutters w-100">
    <div id="logo">
      <img priority class="img-fluid pad-fix" ngSrc="assets/png/logo-text-purple.png"
           alt="Spirit Haven Typographical Logo" height="50" width="433.5" routerLink="" routerLinkActive="active"
           ariaCurrentWhenActive="page">
      <!-- Spirit Haven Logo Text -->
    </div>

    <!-- Visible to ALL -->
    <!-- ABOUT -->
    <ng-container>
      <div class="nav-item">
        <a class="btn" type="button">
          <span class="hover" routerLink="about" routerLinkActive="active" ariaCurrentWhenActive="page">About</span>
        </a>
      </div>
    </ng-container>

    <!-- COMMUNITY -->
    <ng-container>
      <div class="nav-item" (mouseover)="openDropdown('community')">
        <div class="dropdown">
          <a id="community" class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"
             data-bs-auto-close="true" data-bs-reference="parent" aria-expanded="false" routerLink="community"
             routerLinkActive="active" ariaCurrentWhenActive="page">
            <span class="hover">Community</span>
          </a>

          <ul class="dropdown-menu" (mouseleave)="closeDropdown('community')">
            <li>
              <h6 class="dropdown-header">Click above to go to Community</h6>
            </li>
            <li>
              <a class="dropdown-item" routerLink="community/membership" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Membership
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="community/governance" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Governance
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="community/policies" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Policies
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="community/merchandise" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Merchandise
              </a>
            </li>
          </ul>
        </div>
      </div>
    </ng-container>

    <!-- FESTIVAL -->
    <ng-container>
      <div class="nav-item">
        <div class="dropdown" (mouseover)="openDropdown('festival')">
          <a id="festival" class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" data-bs-auto-close="true"
             data-bs-reference="parent" aria-expanded="false" routerLink="festivals" routerLinkActive="active"
             ariaCurrentWhenActive="page">
            <span class="hover">Festivals</span>
          </a>

          <ul class="dropdown-menu" (mouseleave)="closeDropdown('festival')">
            <li>
              <h6 class="dropdown-header">Click above to go to Festivals</h6>
            </li>
            <li>
              <a class="dropdown-item" routerLink="festivals/samhain-2023" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Samhain 2023
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="festivals/vending-at-festivals" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Vending at Festivals
              </a>
            </li>
          </ul>
        </div>
      </div>
    </ng-container>

    <!-- SPIRIT HAVEN RANCH -->
    <ng-container>
      <div class="nav-item">
        <div class="dropdown" (mouseover)="openDropdown('ranch')">
          <a id="ranch" class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" data-bs-auto-close="true"
             data-bs-reference="parent" aria-expanded="false" routerLink="ranch" routerLinkActive="active"
             ariaCurrentWhenActive="page">
            <span class="hover">Spirit Haven Ranch</span>
          </a>

          <ul class="dropdown-menu" (mouseleave)="closeDropdown('ranch')">
            <li>
              <h6 class="dropdown-header">Click above to go to Spirit Haven Ranch</h6>
            </li>
            <li>
              <a class="dropdown-item" routerLink="ranch/workends" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                WorkEnds
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="ranch/hosting-at-shr" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Hosting at Spirit Haven Ranch
              </a>
            </li>
            <li>
              <a class="dropdown-item" routerLink="ranch/sacred-spaces" routerLinkActive="active"
                 ariaCurrentWhenActive="page">
                Sacred Spaces Directory
              </a>
            </li>
          </ul>
        </div>
      </div>
    </ng-container>

    <!-- CONTACT -->
    <ng-container>
      <div class="nav-item">
        <a class="btn hover" type="button">
          <span routerLink="contact" routerLinkActive="active" ariaCurrentWhenActive="page">Contact</span>
        </a>
      </div>
    </ng-container>

    <div id="nav-end">
      <ng-container *ngIf="memberAuth; else login">
        <div class="nav-item pad-fix">
          <!-- Visible to Members Regardless of Membership Status -->
          <button mat-icon-button #accountTrigger="matMenuTrigger" [matMenuTriggerFor]="account">
            <mat-icon>person</mat-icon>
          </button>
        </div>

        <mat-menu #account="matMenu" [hasBackdrop]="false">
          <button mat-menu-item ariaCurrentWhenActive="page" disabled>{{memberAuth.prefName}}</button>
          <mat-divider>
          </mat-divider>
          <button mat-menu-item routerLink="" routerLinkActive="active" ariaCurrentWhenActive="page">Account</button>
          <button *ngIf="memberAuth.active" mat-menu-item routerLink="" routerLinkActive="active"
                  ariaCurrentWhenActive="page">Dashboard</button>
          <button mat-menu-item routerLink="" routerLinkActive="active" ariaCurrentWhenActive="page">Logout</button>
        </mat-menu>
      </ng-container>

      <ng-template #login>
        <div class="nav-item pad-fix">
          <button mat-fab extended routerLink="" routerLinkActive="active" ariaCurrentWhenActive="page">
            Login / Register
          </button>
        </div>
      </ng-template>
    </div>

    <div id="nav-menu" class="pad-fix">
      <button id="nav" class="btn" mat-fab (click)="sidenav.toggle()">
        <span class="hover">
          <mat-icon>menu</mat-icon>
        </span>
      </button>
    </div>
  </div>
</mat-toolbar>

<ng-container>
  <mat-sidenav-container>
    <mat-sidenav #sidenav mode="over" fixedInViewport="true" hasBackdrop="true" position="end"
                 [fixedTopGap]="viewportService.navOffset" [fixedBottomGap]="viewportService.footerOffset">
      mat-sidenav
    </mat-sidenav>
    <mat-sidenav-content [ngStyle]="{'min-height.px': viewportService.offsetString()}">
    </mat-sidenav-content>
  </mat-sidenav-container>
</ng-container>
